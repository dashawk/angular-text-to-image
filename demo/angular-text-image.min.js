!function () {
	'use strict';
	angular.module('jmp.textToImage', []).directive('textToImage', ['A', 'w', function (A, w) {
		return {
			restrict: 'E', replace: !0, scope: {options: '=?'}, link: function (t, M, B) {
				function n() {
					e.font = t.options.fontSize + 'px ' + t.options.fontFamily, e.textAlign = t.options.textAlign, c.textBaseline = 'middle', e.fillStyle = 'black', e.lineWidth = 2, e.translate(100, 50), e.fillText(t.options.text, t.options.textLeft, t.options.textTop), t.updateDataUrl(c[0].toDataURL('image/png')), M.append(c), A(c)(t)
				}
				
				var D = {
						text: '',
						textAlign: 'center',
						textLeft: 50,
						textTop: 50,
						fontSize: 30,
						width: 100,
						height: 100,
						fontFamily: 'sans-serif'
					}, c = angular.element('<canvas />'), e = c[0].getContext('2d'),
					o = 'data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAjgAAADcCAQAAADXNhPAAAACIklEQVR42u3UIQEAAAzDsM+/6UsYG0okFDQHMBIJAMMBDAfAcADDATAcwHAAwwEwHMBwAAwHMBzAcAAMBzAcAMMBDAcwHADDAQwHwHAAwwEMB8BwAMMBMBzAcADDATAcwHAADAcwHADDAQwHMBwAwwEMB8BwAMMBDAfAcADDATAcwHAAwwEwHMBwAAwHMBzAcAAMBzAcAMMBDAcwHADDAQwHwHAAwwEwHMBwAMMBMBzAcAAMBzAcwHAADAcwHADDAQwHMBwAwwEMB8BwAMMBDAfAcADDATAcwHAAwwEwHMBwAAwHMBzAcCQADAcwHADDAQwHwHAAwwEMB8BwAMMBMBzAcADDATAcwHAADAcwHMBwAAwHMBwAwwEMBzAcAMMBDAfAcADDAQwHwHAAwwEwHMBwAAwHMBzAcAAMBzAcAMMBDAcwHADDAQwHwHAAwwEMB8BwAMMBMBzAcADDATAcwHAADAcwHMBwAAwHMBwAwwEMB8BwAMMBDAfAcADDATAcwHAAwwEwHMBwAAwHMBzAcAAMBzAcAMMBDAcwHADDAQwHwHAAwwEMB8BwAMMBMBzAcADDkQAwHMBwAAwHMBwAwwEMBzAcAMMBDAfAcADDAQwHwHAAwwEwHMBwAMMBMBzAcAAMBzAcwHAADAcwHADDAQwHMBwAwwEMB8BwAMMBMBzAcADDATAcwHAADAcwHMBwAAwHMBwAwwEMBzAcAMMBDAegeayZAN3dLgwnAAAAAElFTkSuQmCC';
				t.updateDataUrl = function (A) {
					w().then(function () {
						t.options.dataUrl = t.options.text ? A : o
					})
				}, t.getData = function () {
					return {isEmpty: '' === t.options.text || !t.options.text, data: t.options.dataUrl}
				}, t.init = n, t.options = angular.extend(D, t.options), t.options.getData = t.getData, c[0].width = parseInt(t.options.width, 10), c[0].height = parseInt(t.options.height, 10), t.$watch('options', function (A) {
					A && w(function () {
						n()
					})
				})
			}
		}
	}])
}();
